```julia
using NPZ
using Interpolations
using Polynomials, SpecialPolynomials
using Cubature
import Base.print_matrix # print_matrix()
using Plots

pyplot()
#plotly() #zoomable results


dir = homedir()
filename = "Research/camb_test.npy"
filepath = "$dir/$filename"

function main()
    camb = npzread(filepath)
    Inter = LinearInterpolation(camb[:,1], camb[:,2])
    R = LinRange( 0.0001,2.3,10000) #must be within original range  

    
    p0 = Legendre([1])
    p2 = Legendre([0, 0, 1])
    p4 = Legendre([0, 0, 0, 0, 1])
    #println("$p0 \n $p2 \n $p4")
    #println(convert(Polynomial, p2)) #will show function

    b = 0
    f = 1
    P(k, μ, pn) = Inter(k) * (b + μ^2 * f)^2 * pn(μ)

    #hcubature(x -> P(x[1], x[2], p0), [0.1,-1],[0.2,1], abstol=1e-8)

    #from 0 to 0.2 in steps of 0.01
    
    k = 0:0.01:0.2
    
    p0_bin = zeros(length(k) - 1)
    println("\n","p0 bin")
    for i in 2 :length(k) - 1
        pval = hcubature(x -> P(x[1], x[2], p0), [k[i],-1],[k[i + 1],1], abstol=1e-8)
        p0_bin[i] = pval[1] 
        println("k: ", k[i] ," to ", k[i + 1] , "  p: ", pval)
    end

    p2_bin = zeros(length(k) - 1)
    println("\n","p2 bin")
    
    for i in 2 :length(k) - 1
        pval = hcubature(x -> P(x[1], x[2], p2), [k[i],-1],[k[i + 1],1], abstol=1e-8)
        p2_bin[i] = pval[1] 
        println("k: ", k[i] ," to ", k[i + 1] , "  p2: ", pval)
    end
  
    #hcubature(x -> P(x[1], x[2], p0), [0.1,-1],[0.2,1], abstol=1e-8)

    #Plotting----------------------------------------------
    #plot(camb[:,1], camb[:,2]) #Interpolation overlap
    #display(plot!(R, Inter(R)))


    #logR = log10.(LinRange( 0.0001,2.3,10000))
    #display(plot(logR, log10.(Inter(R))))
    x = 1:20
    display(plot(x, p0_bin))
    display(plot(x, p2_bin))

    #-----------------------------------------------------



end 

main()
```

```
p0 bin
k: 0.01 to 0.02  p: (115.10068177034884, 1.1510024888373082e-6)
k: 0.02 to 0.03  p: (99.9581149860711, 9.994542098375935e-7)
k: 0.03 to 0.04  p: (74.70587762653845, 7.464420623362412e-7)
k: 0.04 to 0.05  p: (57.65860607335262, 5.750004751333072e-7)
k: 0.05 to 0.06  p: (49.052242379641505, 4.904380584793971e-7)
k: 0.06 to 0.07  p: (43.24734630369961, 4.3184992776078995e-7)
k: 0.07 to 0.08  p: (36.64595353644395, 3.640451444238084e-7)
k: 0.08 to 0.09  p: (29.453740220320658, 2.9161361782593976e-7)
k: 0.09 to 0.1  p: (23.699656315153216, 2.3648189090099523e-7)
k: 0.1 to 0.11  p: (20.38427028718383, 2.0035143360306557e-7)
k: 0.11 to 0.12  p: (18.675408882657372, 1.851903483590764e-7)
k: 0.12 to 0.13  p: (17.150079154258137, 1.7005415538183917e-7)
k: 0.13 to 0.14  p: (15.123317779456986, 1.5100232136905497e-7)
k: 0.14 to 0.15  p: (12.869274654712525, 1.2778845632203125e-7)
k: 0.15 to 0.16  p: (11.05516149510817, 1.0822758381536903e-7)
k: 0.16 to 0.17  p: (9.929355000403124, 9.902421875031682e-8)
k: 0.17 to 0.18  p: (9.268305017141996, 9.229780212772856e-8)
k: 0.18 to 0.19  p: (8.662006767517175, 8.619735702770365e-8)
k: 0.19 to 0.2  p: (7.879655172236479, 7.785331940304061e-8)

p2 bin
k: 0.01 to 0.02  p2: (65.77181816124687, 6.575307602022287e-7)
k: 0.02 to 0.03  p2: (57.118922974749054, 5.708004281460594e-7)
k: 0.03 to 0.04  p2: (42.689072795798445, 4.2683004514615355e-7)
k: 0.04 to 0.05  p2: (32.947774773995725, 3.289918853204002e-7)
k: 0.05 to 0.06  p2: (28.029852762764165, 2.7997163573503697e-7)
k: 0.06 to 0.07  p2: (24.71276910478561, 2.468899711948204e-7)
k: 0.07 to 0.08  p2: (20.940544758166272, 2.0798081107081568e-7)
k: 0.08 to 0.09  p2: (16.830708666216022, 1.6790232330441493e-7)
k: 0.09 to 0.1  p2: (13.542660752680142, 1.3536323229078052e-7)
k: 0.1 to 0.11  p2: (11.648154475032856, 1.1621710150609365e-7)
k: 0.11 to 0.12  p2: (10.671662203858558, 1.0669532385568819e-7)
k: 0.12 to 0.13  p2: (9.800045248760512, 9.786241751522715e-8)
k: 0.13 to 0.14  p2: (8.641895864327632, 8.634273369553711e-8)
k: 0.14 to 0.15  p2: (7.353871213583574, 7.346446268996197e-8)
k: 0.15 to 0.16  p2: (6.317235129290988, 6.308180348474301e-8)
k: 0.16 to 0.17  p2: (5.673917147569412, 5.6681929125837555e-8)
k: 0.17 to 0.18  p2: (5.29617429603416, 5.261709347556431e-8)
k: 0.18 to 0.19  p2: (4.949718157277139, 4.9343526370500916e-8)
k: 0.19 to 0.2  p2: (4.502660158719643, 4.498851305550325e-8)
```


![](figures/Interpolation_0_1.png)
![](figures/Interpolation_0_2.png)
